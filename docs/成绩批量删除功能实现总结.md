# 成绩批量删除功能实现总结

## 需求
在成绩管理-成绩查询界面中，添加批量删除功能，注意不要添加任何新的 API，通过多次请求实现。

## 实现方案

### 核心思路
利用现有的 `gradeStore.removeGrade()` 方法，通过循环调用实现批量删除，而不是创建新的批量删除 API。

### 技术实现

#### 1. 界面修改
- 在操作按钮区域添加"批量删除"按钮
- 按钮仅对管理员和教师可见
- 按钮状态与选择记录数量联动
- 显示当前选中的记录数量

#### 2. 业务逻辑
```typescript
const batchDelete = async () => {
  // 1. 验证选择
  if (selectedRows.value.length === 0) {
    ElMessage.warning('请先选择要删除的成绩')
    return
  }

  // 2. 确认操作
  await ElMessageBox.confirm(
    `确定要批量删除选中的 ${selectedRows.value.length} 条成绩记录吗？`,
    '批量删除警告',
    { type: 'warning' }
  )

  // 3. 逐个删除
  for (const row of selectedRows.value) {
    await gradeStore.removeGrade(row.id, true) // silent 模式
  }

  // 4. 反馈结果
  // 5. 清空选择并刷新数据
}
```

#### 3. 关键特性
- **Silent 模式**：调用删除 API 时使用 silent 参数，避免重复显示成功消息
- **错误容忍**：单个删除失败不影响其他记录的处理
- **详细反馈**：显示成功/失败数量和失败记录详情
- **状态管理**：自动清空选择状态并刷新数据

### 代码文件修改
- `src/views/grades/GradeQuery.vue`：添加批量删除按钮和方法

### 依赖的现有功能
- `src/stores/grade.ts` 中的 `removeGrade(id, silent)` 方法
- `src/stores/api/grade.ts` 中的 `deleteGrade(id)` API
- Element Plus 的消息和确认框组件

## 优势
1. **无需新 API**：完全复用现有删除接口
2. **实现简单**：只需前端逻辑修改
3. **用户体验好**：提供批量操作的便利性
4. **错误处理完善**：支持部分失败场景
5. **性能可接受**：对于常规数量的记录删除，性能影响不大

## 注意事项
- 大量记录删除时可能需要考虑分批处理
- 删除操作不可逆，需要用户确认
- 网络不稳定时可能有部分删除失败

## 测试要点
- [ ] 权限验证（管理员/教师可见，学生不可见）
- [ ] 按钮状态管理（禁用/启用）
- [ ] 选择记录数量显示
- [ ] 确认对话框
- [ ] 批量删除执行
- [ ] 结果统计反馈
- [ ] 错误处理
- [ ] 数据刷新
- [ ] 选择状态清空