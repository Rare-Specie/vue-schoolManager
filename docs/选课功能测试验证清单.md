# 选课功能测试验证清单

## 修复概述
修复了选课时出现 "course not found" 错误的问题，主要原因是数据库ID和课程编号的混淆使用。

## 修复内容

### 1. 学生详情界面选课逻辑
**文件：** `src/views/students/StudentDetail.vue`
- **问题：** 直接传递数据库ID给选课API
- **修复：** 先查找课程获取课程编号，再调用API

### 2. Course Store 刷新逻辑
**文件：** `src/stores/course.ts`
- **问题：** 条件判断使用数据库ID匹配课程编号
- **修复：** 统一使用课程编号进行匹配

## 测试验证步骤

### 测试1: 学生详情界面选课
1. **准备数据**
   - 确保有至少1个课程
   - 确保有至少1个学生

2. **操作步骤**
   - 登录管理员/教师账号
   - 进入学生管理 → 点击某个学生进入详情
   - 切换到"选课管理"标签页
   - 在"选择课程"下拉框中选择一个课程
   - 点击"添加选课"按钮

3. **预期结果**
   - ✅ 显示"选课成功"提示
   - ✅ 已选课程列表中出现该课程
   - ✅ 无"course not found"错误

### 测试2: 成绩录入界面选课
1. **操作步骤**
   - 进入成绩录入界面
   - 选择一个课程
   - 点击"选课管理"按钮
   - 选择学生并点击"添加选课"

2. **预期结果**
   - ✅ 选课成功
   - ✅ 学生出现在选课列表中

### 测试3: 选课管理界面批量选课
1. **操作步骤**
   - 进入选课管理界面
   - 选择课程
   - 选择多个学生
   - 点击"批量添加选课"

2. **预期结果**
   - ✅ 批量选课成功
   - ✅ 所有选中学生都被添加

### 测试4: 取消选课功能
1. **操作步骤**
   - 在任何界面执行选课操作
   - 执行取消选课操作

2. **预期结果**
   - ✅ 取消选课成功
   - ✅ 相关成绩被删除

## 边界情况测试

### 测试5: 课程不存在的情况
1. **操作步骤**
   - 手动修改代码，模拟课程列表为空
   - 尝试选课

2. **预期结果**
   - ✅ 显示"找不到对应的课程信息"错误
   - ✅ 不会调用API

### 测试6: 学生无学号的情况
1. **操作步骤**
   - 选择一个没有绑定学号的学生
   - 尝试选课

2. **预期结果**
   - ✅ 显示"当前学生无学号，无法选课"提示

### 测试7: 重复选课
1. **操作步骤**
   - 对同一个学生重复选择同一门课程
   - 观察结果

2. **预期结果**
   - ✅ 第二次选课应被跳过或显示已选提示

## 代码质量验证

### TypeScript 类型检查
```bash
npx vue-tsc --noEmit --skipLibCheck
```
- ✅ 应无类型错误

### ESLint 检查
```bash
npx eslint src/views/students/StudentDetail.vue src/stores/course.ts
```
- ✅ 应无严重错误

## 回归测试

确保修复不影响其他功能：

### 1. 课程管理功能
- ✅ 添加课程
- ✅ 编辑课程
- ✅ 删除课程

### 2. 学生管理功能
- ✅ 添加学生
- ✅ 编辑学生
- ✅ 删除学生

### 3. 成绩管理功能
- ✅ 录入成绩
- ✅ 查询成绩
- ✅ 删除成绩

### 4. 其他选课相关功能
- ✅ 查看选课学生列表
- ✅ 导出选课数据
- ✅ 打印选课报表

## 性能测试

### 大量数据测试
1. **准备数据**
   - 创建100个课程
   - 创建1000个学生

2. **测试操作**
   - 批量选课50个学生
   - 观察响应时间

3. **预期结果**
   - ✅ 操作在合理时间内完成
   - ✅ 界面不卡顿

## 测试报告模板

```
测试日期：____
测试人员：____
环境：____

【测试1 学生详情选课】
状态：□ 通过 □ 失败
备注：____

【测试2 成绩录入选课】
状态：□ 通过 □ 失败
备注：____

【测试3 批量选课】
状态：□ 通过 □ 失败
备注：____

【测试4 取消选课】
状态：□ 通过 □ 失败
备注：____

【边界情况测试】
状态：□ 通过 □ 失败
备注：____

【回归测试】
状态：□ 通过 □ 失败
备注：____

【性能测试】
状态：□ 通过 □ 失败
备注：____

总体结论：____
```

## 修复验证标准

✅ **修复成功标准：**
1. 所有选课操作不再出现 "course not found" 错误
2. 选课功能正常工作
3. 取消选课功能正常工作
4. 不影响其他功能
5. 代码无类型错误
6. 用户体验良好

⚠️ **如果测试失败：**
1. 检查浏览器控制台错误信息
2. 检查网络请求是否正确
3. 检查后端API是否正常
4. 检查数据是否正确加载